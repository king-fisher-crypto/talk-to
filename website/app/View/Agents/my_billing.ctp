<section class="my-billing utilities page">
    <div class="facturation-bloc">
        <h1> Ma facturation & Gains</h1>
        <p>Cette page détaille votre chiffre d'affaire et le règlement est effectué automatiquement entre le 1er et le 07 de chaque mois.</p>
    </div>
    <div class="bills-bloc">
        <div class="months">
            <div class="btns popup-container">
                <a id="btn_datepicker" class="btn spe1  date transparent daterange b " title="<?= __('dates') ?>"><img
                        src="/theme/black_blue/img/calendrier.svg"> <span>Janvier 2022</span></a>
            </div>
            <div class="transaction-container">
                <div class="transaction-details">
                    <h3>Total Téléphone </h3>
                    <p>15h 52 min 25 sec</p>
                    <span>+ 65,52 $</span>
                </div>
                <div class="transaction-details">
                    <h3>Total Chat</h3>
                    <p>15h 52 min 25 sec</p>
                    <span>+ 65,52 $</span>
                </div>
                <div class="transaction-details">
                    <h3>Total Webcam </h3>
                    <p>15h 52 min 25 sec</p>
                    <span>+ 65,52 $</span>
                </div>
                <div class="transaction-details">
                    <h3>Total Email</h3>
                    <p>25 mails</p>
                    <span>+ 65,52 $</span>
                </div>
                <div class="transaction-details">
                    <h3>Total SMS</h3>
                    <p>25 forfait SMS</p>
                    <span>+ 65,52 $</span>
                </div>
             

            </div>
        </div>

        <div class="additional-sales">
            <h3>Mes ventes additionnelles</h3>
            <div class="transaction-container">
                <div class="transaction-details">
                    <h3>Vidéos formation </h3>
                    <p>33 formations</p>
                    <span>+ 122,26 $</span>
                </div>
                <div class="transaction-details">
                    <h3>MasterClass</h3>
                    <p>12 Masterclass</p>
                    <span>+ 122,26 $</span>
                </div>
                <div class="transaction-details">
                    <h3>Vidéos à la demande</h3>
                    <p>43 Videos</p>
                    <span>+ 122,26 $</span>
                </div>
                <div class="transaction-details">
                    <h3>Photos à la demande</h3>
                    <p>33 Photos</p>
                    <span>+ 122,26 $</span>
                </div>
              
                <div class="transaction-details">
                    <h3>Documents-PDF</h3>
                    <p>21 Documents</p>
                    <span>+ 122,26 $</span>
                </div>
                <div class="transaction-details">
                    <h3>Mes requêtes paiements clients</h3>
                    <p>15 Requêtes</p>
                    <span>+ 122,26 $</span>
                </div>
                <div class="transaction-details">
                    <h3>Mes abonnements</h3>
                    <p>20 abonnements</p>
                    <span>+ 250 $</span>
                </div>
                <div class="transaction-details">
                    <h3>Pourboire</h3>
                    <p>25 pourboires</p>
                    <span>+ 65,52 $</span>
                </div>

            </div>
        </div>





        <div class="cadre_table ">
            <div class="overflow jswidth stries-table-container">
                <img class="arrow_right shake" src="/theme/black_blue/img/arrow_right.svg">
                <table class="stries">
                    <tbody>

                        <tr>
                            <td class="agent">Vidéos formation </td>
                            <td class="prestation">33 formations</td>
                            <td class="date">+ 122,26 $</td>

                        </tr>

                        <tr>
                            <td class="agent">MasterClass</td>
                            <td class="prestation">12 Masterclass</td>
                            <td class="date">+ 122,26 $</td>

                        </tr>
                        <tr>
                            <td class="agent">Vidéos à la demande</td>
                            <td class="prestation">43 Videos</td>
                            <td class="date">+ 122,26 $</td>

                        </tr>
                        <tr>
                            <td class="agent">Photos à la demande</td>
                            <td class="prestation">33 Photos</td>
                            <td class="date">+ 122,26 $</td>

                        </tr>
                        <tr>
                            <td class="agent">Documents-PDF</td>
                            <td class="prestation">21 Documents</td>
                            <td class="date">+ 122,26 $</td>
                        </tr>
                        <tr>
                            <td class="agent">Mes requêtes paiements clients</td>
                            <td class="prestation">15 Requêtes</td>
                            <td class="date">+ 122,26 $ </td>

                        </tr>
                        <tr>
                            <td class="agent">Mes abonnements</td>
                            <td class="prestation">20 abonnements</td>
                            <td class="date">+ 250 $ </td>
                        </tr>
                        <tr>
                            <td class="agent">Pourboire</td>
                            <td class="prestation">25 pourboires</td>
                            <td class="date">+ 65,52 $</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="affiliation">
            <div class="affiliation-details">
                <h3>Bonus / Divers</h3>
                <span>+ 0,00$</span>
            </div>
            <div class="affiliation-details">
                <h3>Remboursement clients</h3>
                <span>- 55,00 $</span>
            </div>
            <div class="affiliation-details blue-bloc">
                <h3>Total chiffre d'affaire</h3>
                <span>+ 52 425,74 $</span>
            </div>

            <div class="affiliation-details">
                <h3>Commission site</h3>
                <span>- 9349,30 $</span>
            </div>

            <div class="affiliation-details">
                <h3>Frais CB sur chiffre d'affaire</h3>
                <span>- 2340,30 $</span>
            </div>

            <div class="affiliation-details">
                <h3>Modes Communication</h3>
                <span>- 290,00 $</span>
            </div>

            <div class="affiliation-details">
                <h3>Oeuvres Caritatives</h3>
                <span>- 200,00 $</span>
            </div>

            <div class="affiliation-details">
                <h3>Mes gains Affiliation</h3>
                <span>+ 12,25 $</span>
            </div>
            <div class="affiliation-details blue-bloc">
                <h3>Total</h3>
                <span>+ 48 378,74 $</span>
            </div>

            <div class="affiliation-message">
                <div class="payment">
                    <h3>Réserve tournante mois en cours 10%</h3>
                    <span>- 5 242,57 $</span>
                </div>
                <div class="description">
                    <p>Par mesure de sécurité nous conservons une réserve tournante de 10% permettant de rembourser des
                        clients éventuellement en cas de litige.
                        Elle vous sera attribuée le mois suivant.</p>
                </div>
            </div>
            <div class="affiliation-details">
                <h3>Réserve tournante mois précédent</h3>
                <span>+ 1250,00 $</span>
            </div>

            <div class="affiliation-details blue-bloc">
                <h3>Versement total</h3>
                <span> 36 689,14 $</span>
            </div>
           
            <div class="payment-btn">
                <button id="btnPayment" class=" btn white">
                  Voir mes paiements
                </button>
            </div>

        
        </div>
    </div>
</section>

<script>
    function createPopup(customPicker, targetElement) {
        // create overlay div
        const overlay = document.createElement("div");
        overlay.classList.add("popup-overlay");

        // create popup div
        const popup = document.createElement("div");
        popup.classList.add("popup");
        overlay.appendChild(popup);


        // create years container div
        const yearsContainer = document.createElement("div");
        yearsContainer.classList.add("years-container");
        popup.appendChild(yearsContainer);

        // create close button container div
        const closeBtnContainer = document.createElement("div");
        closeBtnContainer.classList.add("close-btn-container");
        yearsContainer.appendChild(closeBtnContainer);

        // create close button icon
        const closeBtnIcon = document.createElement("img");
        closeBtnIcon.setAttribute("src", "/theme/black_blue/img/recruit/close.svg");
        closeBtnIcon.classList.add("close-btn-icon");
        closeBtnContainer.appendChild(closeBtnIcon);

        // create years div
        const years = document.createElement("div");
        years.classList.add("years");
        yearsContainer.appendChild(years);

        // create left arrow div
        const leftArrow = document.createElement("div");
        leftArrow.classList.add("left-arrow");
        leftArrow.addEventListener("click", (e) => {
            changeYear(-1)
        });
        years.appendChild(leftArrow);

        // create left arrow icon
        const leftArrowIcon = document.createElement("img");
        leftArrowIcon.setAttribute("src", "/theme/black_blue/img/sales/left_arrow.svg");
        leftArrow.appendChild(leftArrowIcon);

        // create year title h2
        const yearTitle = document.createElement("h2");
        yearTitle.innerText = "2022";
        years.appendChild(yearTitle);


        // create right arrow div
        const rightArrow = document.createElement("div");
        rightArrow.classList.add("right-arrow");
        rightArrow.addEventListener("click", (e) => {
            changeYear(1)
        });
        years.appendChild(rightArrow);

        // create right arrow icon
        const rightArrowIcon = document.createElement("img");
        rightArrowIcon.setAttribute("src", "/theme/black_blue/img/sales/right_arrow.svg");
        rightArrow.appendChild(rightArrowIcon);

        let yearsValue = parseInt(yearTitle.innerHTML)

        function changeYear(n) {
            yearsValue += n
            yearTitle.innerHTML = yearsValue
        }

        // create month container div
        const monthContainer = document.createElement("div");
        monthContainer.classList.add("month-container");
        popup.appendChild(monthContainer);

        // create month divs
        const months = ["Janvier", "Février", "Mars", "Avril", "Mai", "Juin", "Juillet", "août", "Septembre", "Octobre", "Novembre", "Décembre"];
        months.forEach((month) => {
            const monthDiv = document.createElement("div");
            monthDiv.classList.add("month");
            monthDiv.innerText = month;
            monthContainer.appendChild(monthDiv);

            monthDiv.addEventListener("click", (e) => {

                customPicker.getElementsByTagName('span').item(0).innerHTML = e.target.innerHTML + " " + yearTitle.innerHTML
                let popupOverlay = document.querySelector(".popup-overlay")
                popupOverlay.classList.remove("show")
            })
        });

        customPicker.addEventListener("click", () => {
            overlay.classList.add("show")
        })

        // add popup to targetElement
        targetElement.appendChild(overlay);

        // add click event listener to close button icon
        closeBtnIcon.addEventListener("click", () => {
            overlay.classList.remove("show")
        });

        overlay.addEventListener("click", (e) => {
            !event.composedPath().includes(popup) && overlay.classList.remove("show")
        });

        window.addEventListener("resize", () => {
            overlay.classList.remove("show")
        })
    }

    window.onload = function () {
        let customPicker = document.querySelector("#btn_datepicker")
        createPopup(customPicker, document.querySelector(".my-billing.page"))
    }
</script>